@using Cpi.Application.Helpers
@using Cpi.Application.DataModels.LookUp

@{
    var currentArea = (ViewContext.RouteData.DataTokens["area"] != null) ? ViewContext.RouteData.DataTokens["area"].ToString() : null;
    var currentController = (ViewContext.RouteData.Values["controller"] != null) ? ViewContext.RouteData.Values["controller"].ToString() : null;
    var roleId = UserHelper.GetRoleId();
}

<div id="main-menu">
    <div class="menu-body">
        <div class="menu-item @(currentArea == "Call" ? "selected" : "")">
            <div class="menu-item-inner">
                <i class="material-icons">call</i>
                <span class="text">Calls 外来电话</span>
            </div>

            <div class="sub-menu">
                <div class="sub-menu-body">
                    <a href="/Call/Call/" class="sub-menu-item"></a>
                </div>
            </div>
        </div>

        @if (roleId == (int)LookUpUserRoleDm.LookUpIds.老子 || roleId == (int)LookUpUserRoleDm.LookUpIds.Admin)
        {
            <div class="menu-item @(currentArea == "Invoice" ? "selected" : "")">
                <div class="menu-item-inner">
                    <i class="material-icons">storage</i>
                    <span class="text">Invoices 订单</span>
                </div>

                <div class="sub-menu">
                    <div class="sub-menu-body">
                        <a href="/Invoice/Invoice" class="sub-menu-item @(currentController == "Invoice" ? "selected" : "")">
                        </a>
                    </div>
                </div>
            </div>

            <div class="menu-item @(currentArea == "Expense" ? "selected" : "")">
                <div class="menu-item-inner">
                    <i class="material-icons">insert_photo</i>
                    <span class="text">Expenses 支出</span>
                </div>

                <div class="sub-menu">
                    <div class="sub-menu-body">
                        <a href="/Expense/Expense/" class="sub-menu-item"></a>
                    </div>
                </div>
            </div>

            <div class="menu-item @(currentArea == "Report" ? "selected" : "")">
                <div class="menu-item-inner">
                    <i class="material-icons">assignment</i>
                    <span class="text">Report 分析报告</span>
                </div>

                <div class="sub-menu">
                    <div class="sub-menu-body">
                        <a href="/Report/FinanceOverview/" class="sub-menu-item @(currentController == "FinanceOverview" ? "selected" : "")">
                            <i class="material-icons">monetization_on</i>
                            <span class="text">Finance Overview 财务概况</span>
                        </a>

                        <a href="/Report/FinanceList/" class="sub-menu-item @(currentController == "FinanceList" ? "selected" : "")">
                            <i class="material-icons">monetization_on</i>
                            <span class="text">Finance Details 财务细节</span>
                        </a>

                        <a href="/Report/Performance/" class="sub-menu-item @(currentController == "Performance" ? "selected" : "")">
                            <i class="material-icons">local_library</i>
                            <span class="text">Performance 员工评估</span>
                        </a>
                    </div>
                </div>
            </div>
        }

        @if (roleId == (int)LookUpUserRoleDm.LookUpIds.老子 || roleId == (int)LookUpUserRoleDm.LookUpIds.Admin)
        {
            <div class="menu-item @(currentArea == "Manage" ? "selected" : "")">
                <div class="menu-item-inner">
                    <i class="material-icons">business</i>
                    <span class="text">Manage 管理</span>
                </div>

                <div class="sub-menu">
                    <div class="sub-menu-body">
                        <a href="/Manage/User/" class="sub-menu-item @(currentController == "User" ? "selected" : "")">
                            <i class="material-icons">people</i>
                            <span class="text">Staff 员工</span>
                        </a>

                        <a href="/Manage/Commodity/" class="sub-menu-item @(currentController == "Commodity" ? "selected" : "")">
                            <i class="material-icons">local_grocery_store</i>
                            <span class="text">Product 产品</span>
                        </a>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

<script type="text/javascript">
    $('.menu-item').click(function () {
        window.location.href = $(this).find('.sub-menu').find('.sub-menu-item:first-child').attr('href');
    });

    $(document).ready(function () {
        $('.menu-item').each(function (index) {
            if ($(this).find('.sub-menu .sub-menu-item').length < 2)
            {
                $(this).find('.sub-menu').css('visibility', 'hidden');
            }
        });
    });
</script>